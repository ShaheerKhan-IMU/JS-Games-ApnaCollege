<!-- <!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Crud App</title>
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.7/dist/css/bootstrap.min.css"
      rel="stylesheet"
    />
  </head>

  <body class="p-4">
    <h1>Crud App</h1>

    <form class="row row-cols-lg-auto g-3 align-items-center mb-4">
      <div class="col-12">
        <label class="visually-hidden" for="inlineFormInputGroupUsername"
          >Username</label
        >
        <div class="input-group">
          <div class="input-group-text">@</div>
          <input
            type="text"
            class="form-control"
            id="inlineFormInputGroupUsername"
            placeholder="Username"
          />
        </div>
      </div>

      <div class="col-12">
        <label class="visually-hidden" for="inlineFormSelectPref"
          >Preference</label
        >
        <select class="form-select" id="inlineFormSelectPref">
          <option selected disabled>Choose Level...</option>
          <option value="Bachelors">Bachelors</option>
          <option value="Masters">Masters</option>
          <option value="PhD">PhD</option>
        </select>
      </div>

      <div class="col-12">
        <div class="form-check">
          <input
            class="form-check-input"
            type="checkbox"
            id="inlineFormCheck"
          />
          <label class="form-check-label" for="inlineFormCheck">
            Remember me
          </label>
        </div>
      </div>

      <div class="col-12">
        <button type="submit" class="btn btn-primary">Submit</button>
      </div>
    </form>

    <ul id="show" class="list-group"></ul>

    <script>
      const form = document.querySelector("form");
      const show = document.getElementById("show");
      const usernameInput = document.getElementById(
        "inlineFormInputGroupUsername"
      );
      const preferenceInput = document.getElementById("inlineFormSelectPref");
      const rememberMeInput = document.getElementById("inlineFormCheck");

      form.addEventListener("submit", (e) => {
        e.preventDefault();

        const username = usernameInput.value.trim();
        const preference = preferenceInput.value;
        const rememberMe = rememberMeInput.checked;

        if (!username || preference === "Choose Level...") {
          alert("Please fill in all fields.");
          return;
        }

        const li = document.createElement("li");
        li.className =
          "list-group-item d-flex justify-content-between align-items-center";
        li.innerHTML = `
          <span>
            <strong>Username:</strong> ${username}, 
            <strong>Preference:</strong> ${preference}, 
            <strong>Remember Me:</strong> ${rememberMe}
          </span>
          <div class="buttons">
            <button type="button" class="btn btn-warning btn-sm me-2 edit-btn">Edit</button>
            <button type="button" class="btn btn-danger btn-sm remove-btn">Remove</button>
          </div>
        `;
        show.appendChild(li);
        form.reset();
      });

      // Event delegation for edit & remove buttons
      show.addEventListener("click", function (e) {
        const target = e.target;

        // Remove functionality
        if (target.classList.contains("remove-btn")) {
          const li = target.closest("li");
          li.remove();
        }

        // Edit functionality
        if (target.classList.contains("edit-btn")) {
          const li = target.closest("li");
          const textSpan = li.querySelector("span").textContent;

          // Extract values from text using regex
          const match = textSpan.match(
            /Username:\s*(.*?),\s*Preference:\s*(.*?),\s*Remember Me:\s*(.*)/
          );
          if (!match) return;

          const [_, username, preference, rememberMe] = match;

          // Fill form with extracted values
          usernameInput.value = username.trim();
          preferenceInput.value = preference.trim();
          rememberMeInput.checked = rememberMe.trim() === "true";

          // Remove the current item (so it can be updated on submit)
          li.remove();
        }
      });
    </script>
  </body>
</html> -->

<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>CRUD App</title>
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.7/dist/css/bootstrap.min.css"
      rel="stylesheet"
    />
  </head>
  <body class="p-4">
    <h1>CRUD App</h1>

    <form class="row row-cols-lg-auto g-3 align-items-center mb-4">
      <div class="col-12">
        <label class="visually-hidden" for="username">Username</label>
        <div class="input-group">
          <div class="input-group-text">@</div>
          <input
            type="text"
            class="form-control"
            id="username"
            placeholder="Username"
          />
        </div>
      </div>

      <div class="col-12">
        <label class="visually-hidden" for="preference">Preference</label>
        <select class="form-select" id="preference">
          <option selected disabled>Choose Level...</option>
          <option value="Bachelors">Bachelors</option>
          <option value="Masters">Masters</option>
          <option value="PhD">PhD</option>
        </select>
      </div>

      <div class="col-12">
        <div class="form-check">
          <input class="form-check-input" type="checkbox" id="rememberMe" />
          <label class="form-check-label" for="rememberMe">Remember me</label>
        </div>
      </div>

      <div class="col-12">
        <button type="submit" class="btn btn-primary">Submit</button>
      </div>
    </form>

    <ul id="show" class="list-group"></ul>

    <script>
      const form = document.querySelector("form");
      const show = document.getElementById("show");

      const usernameInput = document.getElementById("username");
      const preferenceInput = document.getElementById("preference");
      const rememberMeInput = document.getElementById("rememberMe");

      let editTarget = null; // stores the <li> being edited

      form.addEventListener("submit", function (e) {
        e.preventDefault();

        const username = usernameInput.value.trim();
        const preference = preferenceInput.value;
        const rememberMe = rememberMeInput.checked;

        if (!username || preference === "Choose Level...") {
          alert("Please fill all fields");
          return;
        }

        if (editTarget) {
          // Update the existing item
          updateListItem(editTarget, username, preference, rememberMe);
          editTarget = null;
        } else {
          // Create a new list item
          const li = createListItem(username, preference, rememberMe);
          show.appendChild(li);
        }

        form.reset();
      });

      function createListItem(username, preference, rememberMe) {
        const li = document.createElement("li");
        li.className =
          "list-group-item d-flex justify-content-between align-items-center";

        li.dataset.username = username;
        li.dataset.preference = preference;
        li.dataset.rememberMe = rememberMe;

        li.innerHTML = `
        <span><strong>Username:</strong> ${username}, 
               <strong>Preference:</strong> ${preference}, 
               <strong>Remember Me:</strong> ${rememberMe}</span>
        <div>
          <button type="button" class="btn btn-warning btn-sm me-2 edit-btn">Edit</button>
          <button type="button" class="btn btn-danger btn-sm remove-btn">Remove</button>
        </div>
      `;
        return li;
      }

      function updateListItem(li, username, preference, rememberMe) {
        li.dataset.username = username;
        li.dataset.preference = preference;
        li.dataset.rememberMe = rememberMe;

        li.querySelector("span").innerHTML = `
        <strong>Username:</strong> ${username}, 
        <strong>Preference:</strong> ${preference}, 
        <strong>Remember Me:</strong> ${rememberMe}
      `;
      }

      // Handle edit/remove using delegation
      show.addEventListener("click", (e) => {
        const li = e.target.closest("li");
        if (e.target.classList.contains("remove-btn")) {
          li.remove();
        } else if (e.target.classList.contains("edit-btn")) {
          // Load data into the form
          usernameInput.value = li.dataset.username;
          preferenceInput.value = li.dataset.preference;
          rememberMeInput.checked = li.dataset.rememberMe === "true";

          editTarget = li;
        }
      });
    </script>
  </body>
</html>
